<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Requirement Analyzer</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="css/theme.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components/guide-panel.css">
    <link rel="stylesheet" href="css/components/input-panel.css">
    <link rel="stylesheet" href="css/components/history-panel.css">
</head>

<body>
    <!-- Header -->
    <header class="app-header">
        <h1>üîß Requirement Analyzer</h1>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Left: Guide Panel -->
        <div class="guide-panel" id="guidePanelContainer">
            <!-- Rendered by GuidePanel.js -->
        </div>

        <!-- Center: Input Panel -->
        <div class="input-panel">
            <!-- Tab Navigation -->
            <div class="input-tabs">
                <button class="input-tab" data-tab="settings" onclick="switchInputTab('settings')">
                    Settings
                </button>
                <button class="input-tab active" data-tab="direct" onclick="switchInputTab('direct')">
                    Direct Input
                </button>
                <button class="input-tab" data-tab="pattern" onclick="switchInputTab('pattern')">
                    Pattern Input
                </button>
            </div>

            <!-- Tab Content -->
            <div class="input-content">
                <!-- Direct Input Tab -->
                <div id="tab-direct" class="tab-pane active">
                    <!-- Configuration Warning -->
                    <div id="configWarning" class="hidden panel panel-warning" style="margin-bottom: 20px;">
                        <span class="panel-icon">‚ö†Ô∏è</span>
                        <div>
                            <strong>ÏÑ§Ï†ïÏù¥ ÌïÑÏöîÌï©ÎãàÎã§</strong><br>
                            <span style="font-size: 13px;">Settings ÌÉ≠ÏóêÏÑú API ÌÇ§ÏôÄ ÌîÑÎ°úÏ†ùÌä∏ ÏÑ§Ï†ïÏùÑ ÏôÑÎ£åÌï¥Ï£ºÏÑ∏Ïöî.</span>
                        </div>
                    </div>

                    <div class="grid-2" style="margin-bottom: 10px; gap: 15px;">
                        <div class="form-group">
                            <label class="label">Parent Requirement ID</label>
                            <input type="text" class="input-field" id="parentIdDirect" placeholder="Ïòà: REQ-001">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="label">Original Requirement Text</label>
                        <textarea class="textarea-field" id="inputRequirementDirect"
                            placeholder="Enter original requirement text here..."></textarea>
                    </div>

                    <div class="form-group">
                        <button class="btn btn-primary" id="btnImprove" onclick="improveRequirement()">
                            Improve
                        </button>
                    </div>

                    <!-- Loading -->
                    <div id="loadingSection" class="hidden" style="text-align: center; padding: 40px;">
                        <div class="loading-spinner"></div>
                        <p style="color: var(--text-tertiary); font-size: 14px;">AI is analyzing...</p>
                    </div>

                    <!-- Results -->
                    <div id="resultSection" class="hidden results-section">
                        <div style="display: flex; justify-content: flex-end; gap: 10px; margin-bottom: 20px;">
                            <button class="btn btn-secondary" onclick="exportToExcel()"
                                style="padding: 8px 16px; font-size: 13px;">
                                üìä Excel ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                            </button>
                            <button class="btn btn-secondary" onclick="exportToWord()"
                                style="padding: 8px 16px; font-size: 13px;">
                                üìù Word ÎÇ¥Î≥¥ÎÇ¥Í∏∞
                            </button>
                        </div>

                        <!-- Section 1: Score Comparison -->
                        <h2 class="result-header">ÌíàÏßà Ï†êÏàò ÎπÑÍµê</h2>
                        <div class="grid-2" style="margin-bottom: 40px;">
                            <!-- Original Panel -->
                            <div class="score-panel original">
                                <div class="score-total">
                                    <div class="score-number" id="scoreOriginalTotal">0 / 320</div>
                                    <div class="score-percent" id="scoreOriginalPercent">0%</div>
                                </div>
                                <div id="categoryScoresOriginal"></div>
                            </div>

                            <!-- Improved Panel -->
                            <div class="score-panel improved">
                                <div class="score-total">
                                    <div class="score-number" id="scoreImprovedTotal">0 / 320</div>
                                    <div class="score-percent" id="scoreImprovedPercent">0%</div>
                                    <div class="score-delta" id="scoreDeltaText">+0Ï†ê (+0%)</div>
                                </div>
                                <div id="categoryScoresImproved"></div>
                            </div>
                        </div>

                        <!-- Section 2: Detailed Score Table -->
                        <h2 class="result-header">ÏÉÅÏÑ∏ Ï†êÏàò ÎπÑÍµê</h2>
                        <div class="score-table-container" style="margin-bottom: 40px;">
                            <table class="score-table">
                                <thead>
                                    <tr>
                                        <th>Í∑úÏπô</th>
                                        <th>ÏõêÎ≥∏</th>
                                        <th>Í∞úÏÑ†</th>
                                        <th>Î≥ÄÌôî</th>
                                    </tr>
                                </thead>
                                <tbody id="detailedScoreTableBody"></tbody>
                            </table>
                        </div>

                        <!-- Section 3: Improved Requirements Cards -->
                        <h2 class="result-header">Í∞úÏÑ†Îêú ÏöîÍµ¨ÏÇ¨Ìï≠</h2>
                        <div id="requirementCardsContainer" style="margin-bottom: 40px;"></div>

                        <!-- Section 4: Key Improvements -->
                        <h2 class="result-header">Ï£ºÏöî Í∞úÏÑ† ÏÇ¨Ìï≠</h2>
                        <div id="keyImprovementsList"></div>

                        <!-- Section 5: Additional Recommendations -->
                        <h2 class="result-header" style="background: var(--accent-purple); margin-top: 40px;">
                            Ï∂îÍ∞Ä Í∞úÏÑ† Í∂åÏû•ÏÇ¨Ìï≠
                        </h2>
                        <div id="recommendationsList"></div>
                    </div>
                </div>

                <!-- Pattern Input Tab -->
                <div id="tab-pattern" class="tab-pane">
                    <!-- Project Context Fields -->
                    <div class="project-context-box">
                        <h4>ÌîÑÎ°úÏ†ùÌä∏ ÏÑ§Ï†ï (Ïù¥Î≤à ÏöîÍµ¨ÏÇ¨Ìï≠ÏóêÎßå Ï†ÅÏö©)</h4>
                        <div class="form-group">
                            <label class="label">Îã¥ÎãπÏûê (Îã¥ÎãπÎ∂ÄÏÑú)</label>
                            <input type="text" class="input-field" id="patternDeveloper"
                                placeholder="ÎØ∏ ÏûÖÎ†•Ïãú SettingsÏóêÏÑú ÏûêÎèô Î°úÎìú">
                        </div>
                        <div class="form-group">
                            <label class="label">System</label>
                            <input type="text" class="input-field" id="patternSystem"
                                placeholder="ÎØ∏ ÏûÖÎ†•Ïãú SettingsÏóêÏÑú ÏûêÎèô Î°úÎìú">
                        </div>
                        <div class="form-group">
                            <label class="label">Client</label>
                            <input type="text" class="input-field" id="patternClient"
                                placeholder="ÎØ∏ ÏûÖÎ†•Ïãú SettingsÏóêÏÑú ÏûêÎèô Î°úÎìú">
                        </div>
                    </div>

                    <!-- Parent ID & Original Text -->
                    <div class="grid-2" style="margin-bottom: 10px; gap: 15px;">
                        <div class="form-group">
                            <label class="label">Parent Requirement ID</label>
                            <input type="text" class="input-field" id="parentIdPattern" placeholder="Ïòà: REQ-001">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="label">Original Requirement Text</label>
                        <textarea class="textarea-field" id="inputRequirementPattern"
                            placeholder="Enter original requirement text here..."></textarea>
                    </div>

                    <!-- Pattern Selection -->
                    <div class="form-group">
                        <label class="label">Pattern Type</label>
                        <select class="select-field" id="patternSelect" onchange="updatePatternFields()">
                            <option value="ubiquitous">Ubiquitous</option>
                            <option value="event-driven">Event-Driven</option>
                            <option value="unwanted">Unwanted Behavior</option>
                            <option value="state-driven">State-Driven</option>
                            <option value="optional">Optional</option>
                            <option value="complex">Complex</option>
                        </select>
                    </div>

                    <!-- Pattern Fields Container -->
                    <div id="patternFieldsContainer">
                        <!-- Ubiquitous Fields -->
                        <div id="fields-ubiquitous" class="pattern-fields">
                            <div class="form-group">
                                <label class="label">ÏãúÏä§ÌÖú ÏùëÎãµ</label>
                                <input type="text" class="input-field" id="field-system-response"
                                    placeholder="Ïòà: Îç∞Ïù¥ÌÑ∞Î•º Ï†ÑÏÜ°Ìï¥Ïïº ÌïúÎã§">
                            </div>
                        </div>

                        <!-- Event-Driven Fields -->
                        <div id="fields-event-driven" class="pattern-fields hidden">
                            <div class="form-group">
                                <label class="label">ÏÑ†Ìñâ Ï°∞Í±¥</label>
                                <input type="text" class="input-field" id="field-precondition"
                                    placeholder="Ïòà: ÏãúÏä§ÌÖúÏù¥ ÌôúÏÑ±ÌôîÎêú ÏÉÅÌÉúÏóêÏÑú">
                            </div>
                            <div class="form-group">
                                <label class="label">Ìä∏Î¶¨Í±∞ Ïù¥Î≤§Ìä∏</label>
                                <input type="text" class="input-field" id="field-trigger" placeholder="Ïòà: ÏÇ¨Ïö©ÏûêÍ∞Ä Î≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥">
                            </div>
                            <div class="form-group">
                                <label class="label">ÏãúÏä§ÌÖú ÏùëÎãµ</label>
                                <input type="text" class="input-field" id="field-system-response-ed"
                                    placeholder="Ïòà: Í≤ΩÍ≥†ÏùåÏùÑ Ïö∏Î†§Ïïº ÌïúÎã§">
                            </div>
                        </div>

                        <!-- Unwanted Behavior Fields -->
                        <div id="fields-unwanted" class="pattern-fields hidden">
                            <div class="form-group">
                                <label class="label">ÏÑ†Ìñâ Ï°∞Í±¥</label>
                                <input type="text" class="input-field" id="field-precondition-uw"
                                    placeholder="Ïòà: Ï†ïÏÉÅ ÏûëÎèô Ï§ë">
                            </div>
                            <div class="form-group">
                                <label class="label">Í∏àÏßÄ ÎèôÏûë</label>
                                <input type="text" class="input-field" id="field-forbidden"
                                    placeholder="Ïòà: Ïò§Î•ò Î©îÏãúÏßÄÎ•º ÌëúÏãúÌïòÏßÄ ÏïäÏïÑÏïº ÌïúÎã§">
                            </div>
                        </div>

                        <!-- State-Driven Fields -->
                        <div id="fields-state-driven" class="pattern-fields hidden">
                            <div class="form-group">
                                <label class="label">ÌäπÏ†ï Ï°∞Í±¥</label>
                                <input type="text" class="input-field" id="field-condition" placeholder="Ïòà: ÎåÄÍ∏∞ Î™®ÎìúÏùº Îïå">
                            </div>
                            <div class="form-group">
                                <label class="label">ÏãúÏä§ÌÖú ÏùëÎãµ</label>
                                <input type="text" class="input-field" id="field-system-response-sd"
                                    placeholder="Ïòà: Ï†ÑÎ†• ÏÜåÎπÑÎ•º ÏµúÏÜåÌôîÌï¥Ïïº ÌïúÎã§">
                            </div>
                        </div>

                        <!-- Optional Fields -->
                        <div id="fields-optional" class="pattern-fields hidden">
                            <div class="form-group">
                                <label class="label">ÏÑ†ÌÉùÏ†Å Í∏∞Îä•/Ï°∞Í±¥</label>
                                <input type="text" class="input-field" id="field-optional-feature"
                                    placeholder="Ïòà: ÏÇ¨Ïö©ÏûêÍ∞Ä ÏöîÏ≤≠ÌïòÎäî Í≤ΩÏö∞">
                            </div>
                            <div class="form-group">
                                <label class="label">ÏãúÏä§ÌÖú ÏùëÎãµ</label>
                                <input type="text" class="input-field" id="field-system-response-opt"
                                    placeholder="Ïòà: ÏÉÅÏÑ∏ Î°úÍ∑∏Î•º Ï†úÍ≥µÌï† Ïàò ÏûàÎã§">
                            </div>
                        </div>

                        <!-- Complex Fields -->
                        <div id="fields-complex" class="pattern-fields hidden">
                            <div class="form-group">
                                <label class="label">ÏÑ†Ìñâ Ï°∞Í±¥</label>
                                <input type="text" class="input-field" id="field-precondition-cx"
                                    placeholder="Ïòà: Ï¥àÍ∏∞Ìôî ÏôÑÎ£å ÌõÑ">
                            </div>
                            <div class="form-group">
                                <label class="label">Ìä∏Î¶¨Í±∞ Ïù¥Î≤§Ìä∏</label>
                                <input type="text" class="input-field" id="field-trigger-cx" placeholder="Ïòà: Ïã†Ìò∏Î•º ÏàòÏã†ÌïòÎ©¥">
                            </div>
                            <div class="form-group">
                                <label class="label">ÏãúÏä§ÌÖú ÏùëÎãµ</label>
                                <input type="text" class="input-field" id="field-system-response-cx"
                                    placeholder="Ïòà: Îç∞Ïù¥ÌÑ∞Î•º Ï≤òÎ¶¨ÌïòÍ≥† Í≤∞Í≥ºÎ•º Ï†ÑÏÜ°Ìï¥Ïïº ÌïúÎã§">
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <button class="btn btn-primary" onclick="improveRequirement()">
                            Improve
                        </button>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div id="tab-settings" class="tab-pane">
                    <div class="form-group">
                        <label class="label">AI Provider</label>
                        <select class="select-field" id="providerSelect" onchange="toggleApiKeyInputs()">
                            <option value="openai">OpenAI (GPT-4o mini)</option>
                            <option value="gemini">Google Gemini</option>
                            <option value="claude">Anthropic Claude</option>
                        </select>
                    </div>

                    <!-- OpenAI Inputs -->
                    <div id="openaiInputGroup" class="form-group">
                        <label class="label">API URL</label>
                        <input type="text" class="input-field" id="openaiUrlInput" placeholder="API URLÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.">
                        <label class="label" style="margin-top: 10px;">API Key</label>
                        <input type="password" class="input-field" id="openaiKeyInput" placeholder="API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.">
                    </div>

                    <!-- Gemini Inputs -->
                    <div id="geminiInputGroup" class="form-group hidden">
                        <label class="label">API URL</label>
                        <input type="text" class="input-field" id="geminiUrlInput" placeholder="API URLÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.">
                        <label class="label" style="margin-top: 10px;">API Key</label>
                        <input type="password" class="input-field" id="geminiKeyInput" placeholder="API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.">
                    </div>

                    <!-- Claude Inputs -->
                    <div id="claudeInputGroup" class="form-group hidden">
                        <label class="label">API URL</label>
                        <input type="text" class="input-field" id="claudeUrlInput" placeholder="API URLÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.">
                        <label class="label" style="margin-top: 10px;">API Key</label>
                        <input type="password" class="input-field" id="claudeKeyInput" placeholder="API ÌÇ§Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.">
                    </div>

                    <!-- API Save/Reset Buttons -->
                    <div class="form-group" style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" onclick="saveApiConfig()" style="flex: 1;">
                            Save API Key & Use
                        </button>
                        <button class="btn btn-secondary" onclick="resetApiConfig()" style="flex: 1;">
                            Reset API Key
                        </button>
                    </div>

                    <!-- Project Settings -->
                    <div class="form-group"
                        style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-light);">
                        <h3 style="font-size: 16px; margin-bottom: 10px; color: var(--text-primary);">ÌîÑÎ°úÏ†ùÌä∏ ÏÑ§Ï†ï</h3>
                        <p style="font-size: 12px; color: var(--text-tertiary); margin-bottom: 15px;">
                            ÏûÖÎ†• Ïãú AI Ï∂îÎ°† Ï†ïÌôïÎèÑÍ∞Ä Ìñ•ÏÉÅÎê©ÎãàÎã§
                        </p>

                        <label class="label">Îã¥ÎãπÏûê (ÌòëÎ†•ÏÇ¨)</label>
                        <input type="text" class="input-field" id="projectDeveloper" placeholder="Ïòà: Í∞úÎ∞úÌåÄ, Îã¥ÎãπÎ∂ÄÏÑú">

                        <label class="label" style="margin-top: 10px;">System (Ï†úÏñ¥Í∏∞Î™Ö)</label>
                        <input type="text" class="input-field" id="projectSystem" placeholder="Ïòà: ooo ÏãúÏä§ÌÖú, ECU">

                        <label class="label" style="margin-top: 10px;">ÏÇ¨Ïñë Îã¥ÎãπÏûê</label>
                        <input type="text" class="input-field" id="projectClient" placeholder="Ïòà: ÏÑ§Í≥ÑÌåÄ, OOO ÌöåÏÇ¨">
                    </div>

                    <div class="form-group" style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn btn-primary" onclick="saveProjectConfig()" style="flex: 1;">
                            Save Project Settings
                        </button>
                        <button class="btn btn-secondary" onclick="resetProjectConfig()" style="flex: 1;">
                            Reset Project Settings
                        </button>
                    </div>

                    <div id="apiStatus" class="panel panel-warning" style="margin-top: 10px;">
                        <span class="panel-icon">‚ö†Ô∏è</span>
                        <div>Please configure your API keys to use the application.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right: History Panel -->
        <div class="history-panel" id="historyPanelContainer">
            <!-- Rendered by HistoryPanel.js -->
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/main.js"></script>
</body>

</html>